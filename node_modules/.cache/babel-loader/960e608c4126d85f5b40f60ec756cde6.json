{"ast":null,"code":"var _jsxFileName = \"/Users/sarahcosta/Git/m3/s05-09/react-entrega-s2-formulario-de-cadastro-sarahvenske/src/context/UserContext.tsx\",\n    _s = $RefreshSig$();\n\nimport { createContext, useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport api from '../components/Api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const UserContext = /*#__PURE__*/createContext({});\n\nconst UserProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState({});\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  useEffect(() => {\n    async function autoLogin() {\n      const token = localStorage.getItem(\"@context-kenziehub:token\");\n\n      if (token) {\n        try {\n          api.defaults.headers.common.Authorization = `Bearer ${token}`;\n          const {\n            data\n          } = await api.get(\"/profile\");\n          setUser(data);\n        } catch (error) {\n          localStorage.clear();\n        }\n      }\n\n      setLoading(false);\n    }\n\n    autoLogin();\n  }, []);\n\n  const userLogin = data => {\n    api.post(\"/sessions\", data).then(response => {\n      const {\n        user: userResponse,\n        token\n      } = response.data;\n      api.defaults.headers.common.authorization = `Bearer ${token}`;\n      setUser(userResponse);\n      localStorage.setItem(\"@context-kenziehub:token\", token);\n      navigate(\"/dashboard\", {\n        replace: true\n      });\n    }).catch(error => {\n      toast.error(\"Ops! Algo deu errado\");\n    });\n  };\n\n  const userSignup = user => {\n    api.post(\"/users\", user);\n    console.log(user).then(response => {\n      toast.success(\"Conta criada com sucesso!\");\n      navigate(\"/\");\n    }).catch(error => {\n      toast.error(\"Ops! Algo deu errado\");\n    });\n  };\n\n  const userLogout = () => {\n    setUser(null);\n    localStorage.clear();\n    navigate(\"/\", {\n      replace: true\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      user,\n      setUser,\n      loading,\n      userLogin,\n      userSignup,\n      userLogout\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 122,\n    columnNumber: 9\n  }, this);\n};\n\n_s(UserProvider, \"L3cJhY0tLJYm0Gfyh5XlSCj0Oms=\", false, function () {\n  return [useNavigate];\n});\n\n_c = UserProvider;\nexport default UserProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["createContext","useEffect","useState","useNavigate","toast","api","UserContext","UserProvider","children","user","setUser","loading","setLoading","navigate","autoLogin","token","localStorage","getItem","defaults","headers","common","Authorization","data","get","error","clear","userLogin","post","then","response","userResponse","authorization","setItem","replace","catch","userSignup","console","log","success","userLogout"],"sources":["/Users/sarahcosta/Git/m3/s05-09/react-entrega-s2-formulario-de-cadastro-sarahvenske/src/context/UserContext.tsx"],"sourcesContent":["import {createContext, ReactNode, useEffect, useState} from 'react'\nimport { useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify'\nimport api from '../components/Api';\n\ninterface IUserProviderProps {\n    children: ReactNode;\n}\n\ninterface IUserContext {\n    user: IUser | null;\n    setUser: (data: IUser) => void;\n    loading: boolean;\n    userLogin: (data: IUserLogin) => void;\n    userSignup: (user: IUserSignUp) => void; \n    userLogout: any;\n}\n\ninterface ITech {\n    id: string;\n    title: string;\n    status: string;\n    created_at: Date;\n    updated_at: Date;\n}\n\ninterface IUser {\n    id: string;\n    name: string;\n    email: string;\n    course_module: string;\n    bio: string;\n    contact: string;\n    avatar_url: string;\n    created_at: Date;\n    updated_at: Date;\n    techs: ITech[];\n}\n\ninterface IResponseSession {\n    user: IUser;\n    token: string;\n}\n\ninterface IUserLogin {\n    email: string;\n    password: string;\n}\n\ninterface IUserSignUp {\n    name: string;\n    email: string;\n    password: string;\n    confirmPassword: string;\n    bio: string;\n    contact: string;\n    course_module: string;\n}\n\nexport const UserContext = createContext({} as IUserContext);\n\nconst UserProvider = ({children} : IUserProviderProps) => {\n\n    const [user, setUser] = useState< IUser | null >({} as IUser);\n    const [loading, setLoading] = useState(true);\n    const navigate = useNavigate();\n\n    useEffect(() => {\n\n        async function autoLogin(){\n            const token = localStorage.getItem(\"@context-kenziehub:token\");\n                if(token){\n                    try{\n                        api.defaults.headers.common.Authorization = `Bearer ${token}`;\n                        const { data } = await api.get(\"/profile\");\n                        setUser(data);\n                    } catch (error){\n                        localStorage.clear();\n                    }\n                }\n                setLoading(false);\n            } \n            autoLogin();\n\n    }, []);\n\n    const userLogin = (data: IUserLogin) => {\n\n        api.post<IResponseSession>(\"/sessions\", data)\n        .then((response) => {\n            const { user: userResponse, token } = response.data\n            api.defaults.headers.common.authorization = `Bearer ${token}`;\n            setUser(userResponse)\n            localStorage.setItem(\"@context-kenziehub:token\", token)\n            navigate(\"/dashboard\", {replace: true})\n        }).catch((error) => {\n            toast.error(\"Ops! Algo deu errado\")\n        })\n    }\n\n    const userSignup = (user: IUserSignUp) => {\n      \n        api.post(\"/users\", user)\n        console.log(user)\n        .then((response) => {\n          toast.success(\"Conta criada com sucesso!\")\n          navigate(\"/\")\n        })\n        .catch((error) => {\n          toast.error(\"Ops! Algo deu errado\");\n        })\n      }\n\n    const userLogout = () => {\n\n        setUser(null)\n        localStorage.clear()\n        navigate(\"/\", {replace: true})\n    }\n    \n    return(\n        <UserContext.Provider value={{ user, setUser, loading, userLogin, userSignup, userLogout}}>\n            {children}\n        </UserContext.Provider>\n    )\n}\n\nexport default UserProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module"}